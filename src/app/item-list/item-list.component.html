<app-breadcrumbs></app-breadcrumbs>
<app-edit-button></app-edit-button>
<button *ngIf="copyEnabled" type="button" class="btn float-right btn-sm" [ngClass]="copying ? 'btn-dark' : 'btn-outline-dark'" (click)="copying = !copying">Copy</button>
<h4 class="d-inline">{{ route.snapshot.data.regionName }}</h4>
<a class="badge badge-primary align-text-top" routerLink="quiz">Quiz</a>
<!-- <label *ngIf="copyEnabled"><input type="checkbox" [(ngModel)]="copying"/> Copy</label> -->
<div *ngIf="editState.edit | async; else noEdit">
	<app-edit-string
		*ngFor="let item of items"
		label="Item"
		[text]="item.name"
		(update)="update(item.key, $event)"
		(delete)="delete(item.key)"
		></app-edit-string>
	<app-add-string label="Item" (newString)="add($event)"></app-add-string>
</div>
<ng-template #noEdit>
	<ul class="list-group my-3">
		<li *ngFor="let item of items" class="list-group-item">
			<input *ngIf="copyEnabled && copying" type="checkbox" class="mr-2" [ngModel]="item.copy" (ngModelChange)="setCopy(item, $event)"/>
			<a [routerLink]="item.key">{{item.name}}</a>
			<a class="badge badge-primary float-right" [routerLink]="[item.key, 'quiz']">Quiz</a>
		</li>
	</ul>
</ng-template>
<div *ngIf="copyEnabled && copying && copyCount" class="form-inline">
	<label class="mr-2">Copy {{ copyCount }} selected items to:</label>
	<select class="form-control mr-2" [(ngModel)]="selectedRegion">
		<option value="">New region</option>
		<option *ngFor="let region of myRegions | async" [value]="region.key">{{ region.name }}</option>
	</select>
	<input
		*ngIf="!selectedRegion"
		type="text"
		class="form-control mr-2"
		[(ngModel)]="newRegionName"
		placeholder="Region" />
	<button
		class="btn btn-outline-success"
		type="button"
		[disabled]="!selectedRegion && !newRegionName.trim().length"
		(click)="selectedRegion ? copyToExisting(selectedRegion) : copyToNew(newRegionName.trim())"
		>Copy</button>
</div>